# 电路和固件

您可以在[> 立创开源平台 <](https://oshwhub.com/handle/simgetro-public)找到所有电路设计的原理图和线路设计。

SimGETRO是一套街机风格游戏控制器，您可以参考开源资料自行非商用制作。

## 主控制器

### 规格

- 使用 WCH CH32V203-C8T6 作为主控 RISC-V 架构，CH422 协同作为灯光处理芯片
- 可接入 6PIN 共阳一体微动，供电电压 5V
- 可输出 3 路 WS2811/WS2812 信号
- 可输出 1 路 UART 信号，3.3V，可用于驱动 PN532 读卡器等设备
- 可输出 1 路 SPI 信号，3.3V，可用于驱动磁电编码器等设备
- 可输入 2 路高低电平输入，板载上拉，开漏输入也能得到高电平信号，可用于光电传感器等信号输入
- 可输入 5 路普通按键信号，也可编程做他用
- 预留了调试接口，使用 5V 供电

## 固件

您可以在GitHub上找到[> 主控源代码仓库 <](https://github.com/SimDevices-Project/SimGEKI)获取固件源代码。

要使程序能够正常工作，您还需要一并编译和烧入[> IAP程序 <](https://github.com/SimDevices-Project/SimGEKI-IAP)才能正确引导至主程序。

请注意源代码可能随时会更新，并且不保证可用性和完整性，并且源代码仓库并没有利用到完整的芯片能力，欢迎您贡献源代码参与到共同开发之中。

您需要通过编译源代码来获取固件，要编译源代码，请在您的 VSCode 中安装 `EIDE` 作为开发编译环境，并使用 EIDE 安装 `RISCV_GCC` 和 `OPENOCD_WCH 8.2.0` ，如果您使用其他版本的 `openocd` ，请修改 `EIDE项目` 中的 `构建配置->右键菜单` 修改您的工具链路径。请注意，更改工具链版本可能会造成无法编译。

要烧入固件，推荐您使用 `WCHISPTools`，并使用 USB 方式烧入。

## 读卡器

### 说明

早期设计参考了[HINATA](https://hinata.neri.moe/)读卡器天线设计，在此表示感谢。

- 2024-10-13 更新了读卡器PCB电路设计，新的设计兼容性更好，并且可以读取异形卡。

### 规格

- 使用 PN532 作为读卡器 IC，WS2812 作为 LED 灯光
- UART 输入，忘记预留 IRQ 信号
- PN532 使用 3.3V 电源，WS2812 使用 5V 电源
- 4P XH2.54 输入 PN532 电源和 UART 信号
- 3P PH2.0 输入 WS2812 电源和 LED 信号

### 使用

请使用反向 XH2.54 4P 线缆和反向 PH2.0 3P 线缆连接读卡器和主控。**主控仓库的读卡器具体实现还在完善中**，另外在源码中包含了 CDC 直通 PC 测试代码用于硬件测试，期望能有人能够贡献代码一同开发和完善该部分内容。

另外**天线阻抗匹配是使用计算器计算得来**，故不保证阻抗匹配和实际频率工作一致，只能说目前来看勉强能够跑起来，希望能有高人指导更好的阻抗匹配配置。

## 前IO面板

### 说明

提供USB-B和3.5mm音频接入，附带ESD。

### 规格

- USB-B转XH2.54 4P,带ESD
- 3.5mm音频转PH2.0 3P

## 后IO面板

### 说明

3.5mm音频输出

### 规格

- PH2.0 3P转3.5mm音频

## 侧键背光

### 说明

提供侧键背光和光耦信号转接

### 规格

- 一路WS2811信号输入，5V，PH2.0 3P
- 一路光耦信号延长，PH2.0 3P

## 一体式微动

### 说明

提供微动开关信号同时接受LED信号并进行照光，您需要使用配套外壳才能将其固定在按键底部。

### 规格

- PH2.0 6P接口，提供一路开关信号和一路5V共阳RGB信号输入